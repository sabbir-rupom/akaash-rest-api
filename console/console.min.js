var apiItems={},apiUrl="http://"+window.location.hostname,pathExt="/api",tokenHeader="X-API-TOKEN",sessionHeader="X-USER-SESSION-ID";
$(function(){var a=document.location.href;apiUrl!=a&&apiUrl.includes("localhost")&&(apiUrl=a.replace("/console",""),"/"==apiUrl.substr(apiUrl.length-1)&&(apiUrl=apiUrl.slice(0,-1)));$("input[name=baseUrl]").val(apiUrl);$("input[name=apiPath]").val(pathExt);$.getJSON(apiUrl+"/console/api-list.json",function(a){var c=0;$.each(a,function(b,f){"groups"==b&&$.each(f,function(b,d){b=d.contents;var f="apiCollapse_"+c;d='<div class="card"><div class="card-header">'+('<a class="card-link" data-toggle="collapse" href="#'+
f+'">')+d.name;d=d+"</a></div>"+('<div id="'+f+'" class="collapse" data-parent="#apiExample">')+('<ul class="list-group list-group-'+c+' list-group-flush">');$.each(b,function(e,b){apiItems[b]={k:c,obj:a[b]}});d+="</ul></div></div>";$("#apiExample").append(d);c++})})});var b=setInterval(function(){$.isEmptyObject(apiItems)||($.each(apiItems,function(a,b){a='<li class="list-group-item" onclick="callApi(\''+a+"')\">"+b.obj.title+"</li>";$(".list-group-"+b.k).append(a)}),clearInterval(b))},1E3);$("#submit").on("click",
function(){$("#jsonOutput").html("");var a=$("input[name=baseUrl]").val()+$("input[name=apiPath]").val(),b=$("input[name=queryParams]").val(),g=$("textarea[name=requestBody]").val(),h=""!=g?isJson(g):!0,k=$("input[name=sessionToken]").val(),d=$("input:radio[name=method]:checked").val(),l=$("textarea[name=tokenHash]").val();h?$.ajax({url:a+(0<b.length?"?"+b:""),type:d,data:g,contentType:"application/json; charset=utf-8",dataType:"json",async:!1,beforeSend:function(a){a.setRequestHeader(tokenHeader,
l);a.setRequestHeader(sessionHeader,k)},success:function(a,b,c){if(a.hasOwnProperty("data")){var e=a.data;e.hasOwnProperty("session_id")&&$("input[name=sessionToken]").val(e.session_id);e.hasOwnProperty("user_info")&&e.user_info.hasOwnProperty("id")&&$("input[name=userId]").val(e.user_info.id)}"success"==b?$("#jsonOutput").css("background-color","rgb(177, 255, 188)"):$("#jsonOutput").css("background-color","rgb(251, 205, 183)");a=JSON.stringify(a,null,2);$("#jsonOutput").text(syntaxHighlight(a));
console.log(c.getAllResponseHeaders());$("#responseHeader").html(c.getAllResponseHeaders().replace(/\n/g,"<br/>"))},error:function(a){$("#responseHeader").html("HTTP-STATUS: "+a.status+"<br>"+a.getAllResponseHeaders().replace(/\n/g,"<br>"))}}).fail(function(a){if(a.hasOwnProperty("responseJSON"))var b=a.responseJSON;else a.hasOwnProperty("responseText")&&(b=a.responseText);a=JSON.stringify(b,null,2);$("#jsonOutput").css("background-color","rgb(251, 205, 183)");$("#jsonOutput").text(syntaxHighlight(a))}):
alert("invalid JSON")})});
function callApi(a){console.clear();if(apiItems.hasOwnProperty(a)){$('input[name="method"]').prop("checked",!1);a=apiItems[a];var b=a.obj.action;-1!==b.indexOf("login")&&$("textarea[name=tokenHash], input[name=sessionToken], input[name=userId]").val("");$("input[name=apiPath]").val(pathExt+b);$("input[name=method][value="+a.obj.method+"]").prop("checked",!0);$("input[name=queryParams]").val(a.obj.query);$("textarea[name=requestBody]").val(a.obj.json);parseInt($("input[name=userId]").val());b=$("input[name=sessionToken]").val();
a=$("input[name=tokenSecret]").val();var c=(new Date).getTime()+6E4*(new Date).getTimezoneOffset();c={sessionToken:b,reqAt:c};console.log(c);b=CryptoJS.enc.Utf8.parse(JSON.stringify({alg:"HS256",typ:"JWT"}));b=base64url(b);c=CryptoJS.enc.Utf8.parse(JSON.stringify(c));c=base64url(c);a=CryptoJS.HmacSHA256(b+"."+c,a);a=base64url(a);a=b+"."+c+"."+a;$("textarea[name=tokenHash]").val(a);$("#submit").removeAttr("disabled")}$("#jsonOutput").css("background-color","#DDD")}
function base64url(a){a=CryptoJS.enc.Base64.stringify(a);a=a.replace(/=+$/,"");a=a.replace(/\+/g,"-");return a=a.replace(/\//g,"_")}function isJson(a){try{JSON.parse(a)}catch(b){return!1}return!0}function syntaxHighlight(a){"string"!=typeof a&&(a=JSON.stringify(a,void 0,2));return a};